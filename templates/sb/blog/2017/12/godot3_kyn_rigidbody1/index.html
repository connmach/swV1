	<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.54.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Godot 3.0: Rigid Bodies &middot; KCC Blog </title>

  
  <link rel="stylesheet" href="/blog/css/poole.css">
  <link rel="stylesheet" href="/blog/css/syntax.css">
  <link rel="stylesheet" href="/blog/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  
  
  

  <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  
  <link href="" rel="alternate" type="application/rss+xml" title="KCC Blog" />
</head>

	<body class="theme-base-0b">
		<div class="sidebar">
  <div class="container">
      <a href="/blog/">
      <img src="/blog//kcc-logo.png" width="150">
    <div class="sidebar-about">
          
      </a>
      <p class="lead">
       Lessons and info about teaching kids to code. 
      </p>
    </div>

    <ul class="sidebar-nav">
      
      
    </ul>

    
    <div class="sidebar-nav">
        Tags:
        <ul class="sidebar-nav">
                    
                    
                    <li><a href="/blog//tags/education" class="list-group-item">
                        <span class="badge">4</span>
                        education
                    </a></li>
                    
                    <li><a href="/blog//tags/gamedev" class="list-group-item">
                        <span class="badge">59</span>
                        gamedev
                    </a></li>
                    
                    <li><a href="/blog//tags/gamification" class="list-group-item">
                        <span class="badge">1</span>
                        gamification
                    </a></li>
                    
                    <li><a href="/blog//tags/godot" class="list-group-item">
                        <span class="badge">42</span>
                        godot
                    </a></li>
                    
                    <li><a href="/blog//tags/procgen" class="list-group-item">
                        <span class="badge">6</span>
                        procgen
                    </a></li>
                    
                    <li><a href="/blog//tags/pygame" class="list-group-item">
                        <span class="badge">18</span>
                        pygame
                    </a></li>
                    
                    <li><a href="/blog//tags/python" class="list-group-item">
                        <span class="badge">20</span>
                        python
                    </a></li>
                    
                    <li><a href="/blog//tags/shaders" class="list-group-item">
                        <span class="badge">1</span>
                        shaders
                    </a></li>
                    
                    <li><a href="/blog//tags/teaching" class="list-group-item">
                        <span class="badge">5</span>
                        teaching
                    </a></li>
                    
                    <li><a href="/blog//tags/tutorial" class="list-group-item">
                        <span class="badge">59</span>
                        tutorial
                    </a></li>
                    
        </ul>
    </div>
    
    <ul class="soc">
        <li><a class="soc-twitter" href="http://twitter.com/KidsCanCode"></a></li>
        <li><a class="soc-facebook" href="http://facebook.com/Kidscancode"></a></li>
        <li><a class="soc-github" href="https://github.com/kidscancode/"></a></li>
        <li><a class="soc-youtube" href="https://www.youtube.com/c/KidsCanCodeOrg"></a></li>
        <li><a class="soc-rss soc-icon-last" href="/blog/index.xml"></a></li>
    </ul>
    <p>&copy; 2019 KidsCanCode LLC.</p>
  </div>
</div>


		<div class="content container">
			<div class="post">
			 	<h1>Godot 3.0: Rigid Bodies</h1>
			  <span class="post-author">by Chris Bradfield</span>
			  <span class="post-date">Sat, Dec 30, 2017</span>
			  <span id="tags"> <h6>Tags:
			  
			    <a href="/blog/tags/godot">godot</a>
			  
			    <a href="/blog/tags/gamedev">gamedev</a>
			  
			    <a href="/blog/tags/tutorial">tutorial</a>
			  
			</h6></span>

			      <p><img src="/blog/img/godot_logo.png" width="450"></p>

<p>At the time of this writing, Godot 3.0 is nearing release, and many new users are
trying it out. Recently I&rsquo;ve seen a lot of confusion around physics and physics
bodies, especially rigid bodies, which are Godot&rsquo;s &ldquo;true&rdquo; physics nodes.</p>

<p>In this tutorial, I&rsquo;ll explain when (and when not) to use rigid bodies, how they
work, and demonstrate a few handy tricks to bend them to your will. The
examples will use RigidBody2D, but the lessons apply equally to 3D.</p>

<p>You can watch a video version of this lesson here:
<iframe width="560" height="315" src="https://www.youtube.com/embed/xsAyx2r1bQU" frameborder="0" allowfullscreen></iframe></p>

<h2 id="introduction">Introduction</h2>

<p><a href="http://docs.godotengine.org/en/latest/classes/class_rigidbody2d.html" target="_blank"><svg width="18" height="18" class="icon-icon_rigid_body_2d">
<use xlink:href="/blog/img/symbol-defs.svg#icon-icon_rigid_body_2d"></svg> <code>RigidBody2D</code></a>
is the physics body in Godot that provides simulated physics. This means that you
don&rsquo;t control a RigidBody2D directly. Instead you apply forces to it (gravity, impulses,
etc.) and Godot&rsquo;s built-in physics engine calculates the resulting movement, including
collisions, bouncing, rotating, etc.</p>

<p>You can modify a RigidBody2D&rsquo;s behavior via properties such as &ldquo;Mass&rdquo;, &ldquo;Friction&rdquo;,
or &ldquo;Bounce&rdquo;, which can be set in the Inspector:</p>

<p><a href="/blog/img/rigidbody_properties.png"><img src="/blog/img/rigidbody_properties.png" width="200"></a></p>

<p>The body&rsquo;s behavior is also affected by the world, via the <em>Project Settings -&gt; Physics</em>
properties, or by entering an <a href="http://docs.godotengine.org/en/latest/classes/class_area2d.html"><svg width="18" height="18" class="icon-icon_area_2d" target="_blank"><use xlink:href="/blog/img/symbol-defs.svg#icon-icon_area_2d"></svg> <code>Area2D</code></a> that is overriding the global physics properties.</p>

<h2 id="using-rigidbody2d">Using RigidBody2D</h2>

<p>One of the benefits of using a rigid body is that a lot of behavior can be gotten &ldquo;for
free&rdquo; without writing any code. For example, let&rsquo;s look at making a rudimentary
&ldquo;Angry Birds&rdquo;-style game with falling blocks. You only need to create RigidBody2Ds
for the blocks and projectile, and set their properties. Stacking, falling, and bouncing
will automatically be handled by the physics engine.</p>

<h3 id="stacking-blocks">Stacking blocks</h3>

<p>Start by making a RigidBody2D for the block and adding <a href="http://docs.godotengine.org/en/latest/classes/class_sprite.html" target="_blank"><svg width="18" height="18" class="icon-icon_sprite"><use xlink:href="/blog/img/symbol-defs.svg#icon-icon_sprite"></svg><code>Sprite</code></a> and
<a href="http://docs.godotengine.org/en/latest/classes/class_collisionshape2D.html" target="_blank"><svg width="18" height="18" class="icon-icon_collision_shape_2d"><use xlink:href="/blog/img/symbol-defs.svg#icon-icon_collision_shape_2d"></svg><code>CollisionShape2D</code></a>
children:</p>

<p><a href="/blog/img/rigidbody_block_scene.png"><img src="/blog/img/rigidbody_block_scene.png" width="200"></a></p>

<p>Add a texture to the Sprite and a rectangular collision shape. <strong>IMPORTANT</strong>: Do <em>not</em>
change the <em>Scale</em> of the collision shape! In general this is a bad idea, and will
result in unexpected collision behavior. Always use the shape&rsquo;s inner size handles and
not the outer <code>Node2D</code>-derived scale handles.</p>

<blockquote>
<p><strong>NOTE:</strong> For the textures in this example, I&rsquo;m using the <a href="http://kenney.nl/assets/physics-assets">Physics Asset</a> pack from Kenney.nl. It contains a
wide variety of blocks in different shapes and materials.</p>
</blockquote>

<p>Press &ldquo;Play&rdquo; and you&rsquo;ll see the block fall slowly downward. This is due to the
default global gravity. You can find this setting in &ldquo;Project Settings&rdquo; under
<em>Physics -&gt; 2d</em>. You can also try changing the Block&rsquo;s <code>Gravity Scale</code> property in the
Inspector. I&rsquo;m using a value of <code>3</code>.</p>

<p>Now create a Main scene (I usually use a <a href="http://docs.godotengine.org/en/latest/classes/class_node.html" target="_blank"><svg width="18" height="18" class="icon-icon_node"><use xlink:href="/blog/img/symbol-defs.svg#icon-icon_node"></svg>Node</a>) for the root).
Add a few <a href="http://docs.godotengine.org/en/latest/classes/class_staticbody2d.html" target="_blank"><svg width="18" height="18" class="icon-icon_staticbody2d"><use xlink:href="/blog/img/symbol-defs.svg#icon-icon_static_body_2d"></svg>StaticBody2D</a>
nodes with rectangular collision shapes to serve as your &ldquo;ground&rdquo; and walls.</p>

<p>Instance a Block, and then duplicate it (<code>Ctrl-D</code> on Windows and <code>Cmd-D</code> on MacOS)
so you can make a nice stack. Something like this:</p>

<p><a href="/blog/img/rigidbody_scene1.png"><img src="/blog/img/rigidbody_scene1.png" width="350"></a></p>

<h3 id="projectile">Projectile</h3>

<p>Create another scene with the same node setup as your Block, but name this one &ldquo;Ball&rdquo;. Use one of
the round textures and a circular collision shape. Instance this in your Main
scene and place it somewhere to the side of the stack of blocks.</p>

<p>To cause a rigid body to move, it must have some velocity. You can give the body
an initial velocity using the <code>Linear -&gt; Velocity</code> property. Try setting this
to <code>(500, 0)</code>.</p>

<p><a href="/blog/img/rigidbody_vel.gif"><img src="/blog/img/rigidbody_vel.gif" width="200"></a></p>

<p>You can also tinker with the ball&rsquo;s <code>Friction</code> and <code>Bounce</code> properties. Both of
these properties can range from zero to one. I like a bounce of around <code>0.5</code>.</p>

<blockquote>
<p><strong>IMPORTANT:</strong> <em>NEVER</em> scale a physics body! If you try, a warning will appear,
and when the scene runs, the physics engine will automatically set the scale back
to <code>(1, 1)</code>.</p>
</blockquote>

<h3 id="forces">Forces</h3>

<p>Reset the linear velocity to <code>(0, 0)</code>. Now what if you want to be able to toss
the ball? You should never set a rigid body&rsquo;s velocity or position manually -
remember, these are simulating &ldquo;real-world&rdquo; style physics. In the real world,
objects can&rsquo;t instantly jump from place to place or from a standstill to a high
speed. If you try and do so, the physics engine will resist it, and unexpected
movement can occur. Instead, we must apply forces which create an acceleration in a certain
direction (also known as Newton&rsquo;s Second Law). Godot physics objects work in
the same way.</p>

<p>To add force to a rigid body, you have two functions to choose from:</p>

<ul>
<li><code>add_force()</code></li>
</ul>

<p>Adds a continuous force to the body. Imagine a rocket&rsquo;s thrust, steadily
pushing it faster and faster. Note that this <em>adds</em> to any already existing
forces. The force continues to be applied until removed.</p>

<ul>
<li><code>apply_impulse()</code></li>
</ul>

<p>Adds an instantaneous &ldquo;kick&rdquo; to the body. Imagine hitting a baseball with a bat.</p>

<p>We&rsquo;ll use <code>apply_impulse()</code> to kick the ball when we click, drag, and release
the mouse button.</p>

<p>Open &ldquo;Project Settings&rdquo; and in the &ldquo;Input Map&rdquo; tab, add a new action called &ldquo;click&rdquo;.
Connect it to the left mouse button.</p>

<p>Next, add a script to the Ball, and add the following code:</p>

<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="n">extends</span> <span class="n">RigidBody2D</span>

<span class="kd">var</span> <span class="nv">dragging</span>
<span class="kd">var</span> <span class="nv">drag_start</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">()</span>

<span class="kd">func</span> <span class="nf">_input</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s">&#34;click&#34;</span><span class="p">)</span> <span class="n">and</span> <span class="n">not</span> <span class="n">dragging</span><span class="p">:</span>
		<span class="n">dragging</span> <span class="p">=</span> <span class="kc">true</span>
		<span class="n">drag_start</span> <span class="p">=</span> <span class="n">get_global_mouse_position</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">event</span><span class="p">.</span><span class="n">is_action_released</span><span class="p">(</span><span class="s">&#34;click&#34;</span><span class="p">)</span> <span class="n">and</span> <span class="n">dragging</span><span class="p">:</span>
		<span class="n">dragging</span> <span class="p">=</span> <span class="kc">false</span>
		<span class="kd">var</span> <span class="nv">drag_end</span> <span class="p">=</span> <span class="n">get_global_mouse_position</span><span class="p">()</span>
		<span class="kd">var</span> <span class="nv">dir</span> <span class="p">=</span> <span class="n">drag_start</span> <span class="o">-</span> <span class="n">drag_end</span>
		<span class="n">apply_impulse</span><span class="p">(</span><span class="n">Vector2</span><span class="p">(),</span> <span class="n">dir</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span></code></pre></div>

<p>This script toggles <code>dragging</code> on when the mouse button is pressed and records
the location of the click. When the button is released, we find the vector from
the click point to the release point and use that to apply the impulse (multiplying
by <code>5</code> to scale it up). <code>apply_impulse()</code> also takes an <code>offset</code> as its first
parameter. This lets you &ldquo;hit&rdquo; the body off center, if you wish. For instance,
try setting it to <code>Vector2(25, 0)</code> and you&rsquo;ll add some spin to the ball when
it&rsquo;s launched.</p>

<p><a href="/blog/img/rigidbody_impulse.gif"><img src="/blog/img/rigidbody_impulse.gif" width="200"></a></p>

<h2 id="controlling-rigid-bodies">Controlling Rigid Bodies</h2>

<p>There are cases where you need more direct control of a rigid body. For example,
imagine you&rsquo;re trying to make a version of the classic game &ldquo;Asteroids&rdquo;. The
player&rsquo;s spaceship needs to rotate using the left/right arrow keys, and to move
forward when the up arrow is pressed.</p>

<p>Here&rsquo;s the image I&rsquo;m using for my ship:
<a href="/blog/img/ship_red.png"><img src="/blog/img/ship_red.png" width="124"></a>
I recommend you also go to <a href="http://opengameart.org/">OpenGameArt</a> and search for
a nice space background (but this is totally optional).</p>

<p>Create a new scene for the ship as we did above with the following node structure:</p>

<ul>
<li><code>RigidBody2D</code>

<ul>
<li><code>Sprite</code></li>
<li><code>CollisionShape2D</code></li>
</ul></li>
</ul>

<blockquote>
<p><strong>Note:</strong> In Godot 3.0, <code>0</code> degrees points to the right (along the <strong>x</strong> axis).
This means you need to add a <code>Rotation</code> of <code>90</code> to the <code>Sprite</code> so it will
match the body&rsquo;s direction.</p>
</blockquote>

<p>By default, the physics settings provide some <em>damping</em>, which reduces a body&rsquo;s
velocity and spin. In space, there&rsquo;s no friction, so there shouldn&rsquo;t be any
damping at all. However, for the &ldquo;Asteroids&rdquo; feel, we want the ship to stop rotating
when we let go of the keys, so set the ship&rsquo;s <code>Angular -&gt; Damp</code> to <code>5</code>.</p>

<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="n">extends</span> <span class="n">RigidBody2D</span>

<span class="n">export</span> <span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="kd">var</span> <span class="nv">engine_thrust</span>
<span class="n">export</span> <span class="p">(</span><span class="n">int</span><span class="p">)</span> <span class="kd">var</span> <span class="nv">spin_thrust</span>

<span class="kd">var</span> <span class="nv">thrust</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">()</span>
<span class="kd">var</span> <span class="nv">rotation_dir</span> <span class="p">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nv">screensize</span>

<span class="kd">func</span> <span class="nf">_ready</span><span class="p">():</span>
	<span class="n">screensize</span> <span class="p">=</span> <span class="n">get_viewport</span><span class="p">().</span><span class="n">get_visible_rect</span><span class="p">().</span><span class="n">size</span>

<span class="kd">func</span> <span class="nf">get_input</span><span class="p">():</span>
	<span class="k">if</span> <span class="n">Input</span><span class="p">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s">&#34;ui_up&#34;</span><span class="p">):</span>
		<span class="n">thrust</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">(</span><span class="n">engine_thrust</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">thrust</span> <span class="p">=</span> <span class="n">Vector2</span><span class="p">()</span>
	<span class="n">rotation_dir</span> <span class="p">=</span> <span class="mi">0</span>
	<span class="k">if</span> <span class="n">Input</span><span class="p">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s">&#34;ui_right&#34;</span><span class="p">):</span>
		<span class="n">rotation_dir</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">if</span> <span class="n">Input</span><span class="p">.</span><span class="n">is_action_pressed</span><span class="p">(</span><span class="s">&#34;ui_left&#34;</span><span class="p">):</span>
		<span class="n">rotation_dir</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="kd">func</span> <span class="nf">_process</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
	<span class="n">get_input</span><span class="p">()</span>

<span class="kd">func</span> <span class="nf">_physics_process</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
	<span class="n">set_applied_force</span><span class="p">(</span><span class="n">thrust</span><span class="p">.</span><span class="n">rotated</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>
	<span class="n">set_applied_torque</span><span class="p">(</span><span class="n">rotation_dir</span> <span class="o">*</span> <span class="n">spin_thrust</span><span class="p">)</span></code></pre></div>

<p>Let&rsquo;s walk through what this script is doing. The two variables, <code>engine_thrust</code>
and <code>spin_thrust</code> control how fast the ship can accelerate and turn. In the
Inspector, set them to <code>500</code> and <code>25000</code> respectively (the units of torque make
for large numbers). <code>thrust</code> will represent the ship&rsquo;s engine state: <code>(0, 0)</code>
when coasting, or a vector with the length of <code>engine_thrust</code> when powered on.
<code>rotation_dir</code> will represent what direction the ship is turning. The <code>screensize</code>
variable will capture the size of the screen, which we&rsquo;ll be using later.</p>

<p>Next, the <code>input()</code> function captures the keystates and sets the ship&rsquo;s <code>thrust</code>
on or off, and the rotation direction (<code>rotation_dir</code>) positive or negative. This
function is called every frame in <code>_process()</code>.</p>

<p>Finally, physics-related functions should be called in <code>_physics_process()</code>. Here
we use <code>set_applied_force()</code> to apply the <code>thrust</code> in whatever <code>direction</code> the
ship is facing. Then we use <code>set_applied_torque()</code> to cause the ship to rotate.</p>

<p>Play the scene - you should be able to fly around freely.</p>

<p><a href="/blog/img/rigidbody_ship1.gif"><img src="/blog/img/rigidbody_ship1.gif" width="350"></a></p>

<h2 id="the-position-problem">The Position Problem</h2>

<p>Another feature of &ldquo;Asteroids&rdquo; is that the screen &ldquo;wraps around&rdquo;. If the player
goes off one side, it teleports to the other side. But we already talked above
about how you can&rsquo;t change a rigid body&rsquo;s position without breaking the physics
engine. This presents a huge problem when working with rigid bodies.</p>

<p>A common mistake is to try adding something like this to <code>_physics_process()</code>:</p>

<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">_physics_process</span><span class="p">(</span><span class="n">delta</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">screensize</span><span class="p">.</span><span class="n">x</span><span class="p">:</span>
		<span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="mi">0</span>
	<span class="k">if</span> <span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="n">screensize</span><span class="p">.</span><span class="n">x</span>
	<span class="k">if</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">screensize</span><span class="p">.</span><span class="n">y</span><span class="p">:</span>
		<span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="mi">0</span>
	<span class="k">if</span> <span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">position</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="n">screensize</span><span class="p">.</span><span class="n">y</span>
	<span class="n">set_applied_force</span><span class="p">(</span><span class="n">thrust</span><span class="p">.</span><span class="n">rotated</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>
	<span class="n">set_applied_torque</span><span class="p">(</span><span class="n">rotation_dir</span> <span class="o">*</span> <span class="n">spin_thrust</span><span class="p">)</span></code></pre></div>

<p>This fails spectacularly, trapping the player on the edge of the screen (with
occasional glitches). So why doesn&rsquo;t this work? The docs say <code>_physics_process()</code>
is for physics-related stuff, right?</p>

<p>Not exactly. <code>_physics_process()</code> is <em>synced</em> to the physics timestep, but that
doesn&rsquo;t make it OK to use for just anything. Hope is not lost, however, the answer
is in the docs.</p>

<p>To quote the <a href="http://docs.godotengine.org/en/latest/classes/class_rigidbody2d.html#description">RigidBody2D docs</a>:</p>

<blockquote>
<p>You should not change a RigidBody2D’s position or linear_velocity every frame or even very often. If you need to directly affect the body’s state, use <code>_integrate_forces</code>, which allows you to directly access the physics state.</p>
</blockquote>

<p>And the <a href="http://docs.godotengine.org/en/latest/classes/class_rigidbody2d.html#class-rigidbody2d-integrate-forces">description for _integrate_forces</a>:</p>

<blockquote>
<p>Allows you to read and <strong>safely modify</strong> the simulation state for the object. Use this instead of <code>_physics_process</code> if you need to directly change the body’s position or other physics properties.</p>
</blockquote>

<p>So there&rsquo;s our answer. Instead of using <code>_physics_process()</code> we need to use <code>_integrate_forces()</code>,
which gives us access to the <a href="http://docs.godotengine.org/en/latest/classes/class_physics2ddirectbodystate.html" target="_blank">Physics2DDirectBodyState</a>. I highly recommend you take a look at the
linked document, there is a lot of really useful data provided in the physics state object.
For our purposes, the key piece of information is the body&rsquo;s <a href="http://docs.godotengine.org/en/latest/classes/class_transform2d.html" target="_blank">Transform2D</a>.
(Explaining transforms is beyond the scope of this document - see <a href="http://docs.godotengine.org/en/latest/learning/features/math/matrices_and_transforms.html">Matrices and transforms</a>
for more information.)</p>

<p>The body&rsquo;s position is contained in the transform&rsquo;s <code>origin</code>. Change <code>_physics_process()</code>
to <code>_integrate_forces()</code> and add the following code:</p>

<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">_integrate_forces</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
	<span class="n">set_applied_force</span><span class="p">(</span><span class="n">thrust</span><span class="p">.</span><span class="n">rotated</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>
	<span class="n">set_applied_torque</span><span class="p">(</span><span class="n">rotation_dir</span> <span class="o">*</span> <span class="n">spin_thrust</span><span class="p">)</span>
	<span class="kd">var</span> <span class="nv">xform</span> <span class="p">=</span> <span class="n">state</span><span class="p">.</span><span class="n">get_transform</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">screensize</span><span class="p">.</span><span class="n">x</span><span class="p">:</span>
		<span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="mi">0</span>
	<span class="k">if</span> <span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="n">screensize</span><span class="p">.</span><span class="n">x</span>
	<span class="k">if</span> <span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">screensize</span><span class="p">.</span><span class="n">y</span><span class="p">:</span>
		<span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="mi">0</span>
	<span class="k">if</span> <span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
		<span class="n">xform</span><span class="p">.</span><span class="n">origin</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="n">screensize</span><span class="p">.</span><span class="n">y</span>
	<span class="n">state</span><span class="p">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">xform</span><span class="p">)</span></code></pre></div>

<p>We grab the current transform, change it as necessary, and set it back as the new
transform. The physics engine stays happy, and everything works as expected:
<a href="/blog/img/rigidbody_ship2.gif"><img src="/blog/img/rigidbody_ship2.gif" width="350"></a></p>

<h2 id="conclusion">Conclusion</h2>

<p>When used properly, rigid bodies are a powerful tool in your Godot toolkit. Many
users get in trouble, however, when they use them for the wrong purposes, or
fail to understand exactly how they work.</p>

<p>I hope you found this (fairly long) lesson useful. As Godot 3.0 nears release,
I&rsquo;ll be putting out more &ldquo;Know Your Nodes&rdquo; and other 3.0-related content. Good
luck, and happy game making!</p>

<h3 id="helpful-links">Helpful Links:</h3>

<ul>
<li><a href="https://godotengine.org/article/dev-snapshot-godot-3-0-beta-2">Download Godot 3.0 Beta 2</a></li>
<li><a href="https://www.patreon.com/kidscancode">Support Me on Patreon</a></li>
</ul>
			</div>


				<h2>Comments</h2>
				<div id="disqus_thread"></div>
<script type="text/javascript">
    
    
    
    

     
    var disqus_shortname = 'kidscancode'; 

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


		</div>
        
  </body>
</html>
